<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Political Election Campaign Management System - Maldives</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAABM0lEQVR4nO2WQU7DMBBFX8qBC1SxQ1Uu0Bu0d+CGC8AF4AhwgXYHqAcgwAHgAhUckEpCJrITj+2JEDOyPNY489mZ8cSJiIiIiIiI/A0KQAUYAB1gCuTAFGgBXaAPlHGzAHaAg0t4B3wBD8BJfvw2UApMjysw2h08AXz7+ISGdxF+BEw6Yk7vO6BR4i9gWeLvfuFPYGxiLq0r8HlVH4E5MAZ64oNO3/gxk0WKrxV4CjSCP2V+s15g1QpUwDz4U+U3KwW6QR+Cp8D7z5gJ1vwNN6P4Qwp9BY7/nDnMPSbwq3XGC3rAtP8X4OvOPGMCL7AFxoK7k/5VaBd4CJz4PzADPgNvQX8CBsAX8AG8Aq/AE/AIPAC3wBWwB5wCO8AJsAVsAhvAGrAKLAMrwBKwyC/wCxx7XuDYC6S+HL7vAf+K98/1wKWa+QAAAABJRU5ErkJggg==">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="pages-styles.css">
    <link rel="stylesheet" href="messenger-styles.css">
    <script type="module" src="dialog.js"></script>
    <script>
        // Detect if opened via file:// protocol and show error
        if (window.location.protocol === 'file:') {
            document.write(`
                <style>
                    body { 
                        font-family: Arial, sans-serif; 
                        text-align: center; 
                        padding: 50px; 
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                    }
                    .error-box {
                        background: rgba(255,255,255,0.95);
                        color: #333;
                        padding: 40px;
                        border-radius: 15px;
                        max-width: 600px;
                        margin: 50px auto;
                        box-shadow: 0 10px 40px rgba(0,0,0,0.3);
                    }
                    h1 { color: #dc3545; margin-bottom: 20px; }
                    .button {
                        display: inline-block;
                        background: #667eea;
                        color: white;
                        padding: 15px 30px;
                        text-decoration: none;
                        border-radius: 8px;
                        margin: 10px;
                        font-weight: bold;
                    }
                    code {
                        background: #f4f4f4;
                        padding: 2px 8px;
                        border-radius: 4px;
                        font-family: monospace;
                    }
                </style>
                <div class="error-box">
                    <h1>⚠️ WRONG WAY TO OPEN THIS FILE!</h1>
                    <p style="font-size: 18px; margin: 20px 0;">
                        You opened this file directly from your computer.<br>
                        This causes CORS errors and won't work!
                    </p>
                    <p style="margin: 30px 0;">
                        <strong>You MUST use the HTTP server instead:</strong>
                    </p>
                    <div style="margin: 30px 0;">
                        <a href="http://localhost:8000/index.html" class="button">Open via Server (Port 8000)</a><br><br>
                        <a href="http://localhost:8080/index.html" class="button">Open via Server (Port 8080)</a>
                    </div>
                    <div style="background: #fff3cd; padding: 20px; border-radius: 8px; margin-top: 30px; text-align: left;">
                        <strong>How to fix:</strong><br>
                        1. Make sure server is running (check terminal)<br>
                        2. Click one of the buttons above<br>
                        3. Or type in browser: <code>http://localhost:8000/index.html</code><br>
                        4. <strong>NEVER</strong> double-click HTML files!
                    </div>
                </div>
            `);
            // Stop execution
            throw new Error('File opened via file:// protocol');
        }
    </script>
</head>

<body class="loading-auth">
    <!-- Onboarding Login Screen (First-time setup with temporary password) -->
    <div id="onboarding-login-screen" class="screen">
        <div class="auth-container">
            <div class="auth-card">
                <div class="logo-header">
                    <h1>Election Campaign System</h1>
                    <p class="subtitle">Maldives Political Campaign Management</p>
                    <p style="font-size: 14px; color: var(--primary-color); margin-top: 12px; font-weight: 600;">
                        Initial Account Setup
                    </p>
                    <p style="font-size: 12px; color: var(--text-light); margin-top: 8px;">
                        <a href="admin.html" style="color: var(--primary-color); text-decoration: none;">Admin Login</a>
                    </p>
                </div>
                <form id="onboarding-login-form" class="auth-form">
                    <div class="form-group">
                        <label for="onboarding-email">Email Address</label>
                        <input type="email" id="onboarding-email" placeholder="Enter your email" required>
                    </div>
                    <div class="form-group">
                        <label for="onboarding-password">Temporary Password</label>
                        <input type="password" id="onboarding-password" placeholder="Enter temporary password" required>
                    </div>
                    <div id="onboarding-login-error" class="error-message"></div>
                    <button type="submit" class="btn-primary">Start Setup</button>
                    <p style="text-align: center; margin-top: 16px; font-size: 13px; color: var(--text-light);">
                        Already completed setup? <a href="#" id="switch-to-client-login" style="color: var(--primary-color); text-decoration: none;">Login to your account</a>
                    </p>
                </form>
            </div>
        </div>
    </div>

    <!-- Regular Client Login Screen (For returning clients) -->
    <div id="client-login-screen" class="screen">
        <div class="auth-container">
            <div class="auth-card">
                <div class="logo-header">
                    <h1>Election Campaign System</h1>
                    <p class="subtitle">Maldives Political Campaign Management</p>
                    <p style="font-size: 12px; color: var(--text-light); margin-top: 8px;">
                        <a href="admin.html" style="color: var(--primary-color); text-decoration: none;">Admin Login</a>
                    </p>
                </div>
                <form id="client-login-form" class="auth-form">
                    <div class="form-group">
                        <label for="client-login-email">Email Address</label>
                        <input type="email" id="client-login-email" placeholder="Enter your email" required>
                    </div>
                    <div class="form-group">
                        <label for="client-login-password">Password</label>
                        <input type="password" id="client-login-password" placeholder="Enter your password" required>
                    </div>
                    <div id="client-login-error" class="error-message"></div>
                    <button type="submit" class="btn-primary">Login</button>
                    <p style="text-align: center; margin-top: 16px; font-size: 13px; color: var(--text-light);">
                        First time? <a href="#" id="switch-to-onboarding" style="color: var(--primary-color); text-decoration: none;">Start initial setup</a>
                    </p>
                </form>
            </div>
        </div>
    </div>

    <!-- Password Change Screen -->
    <div id="password-change-screen" class="screen">
        <div class="auth-container">
            <div class="auth-card">
                <div class="logo-header">
                    <h2>Change Password</h2>
                    <p class="subtitle">Please set a new password for your account</p>
                </div>
                <form id="password-change-form" class="auth-form">
                    <div class="form-group">
                        <label for="new-password">New Password</label>
                        <input type="password" id="new-password" placeholder="Enter new password" required minlength="6">
                    </div>
                    <div class="form-group">
                        <label for="confirm-password">Confirm New Password</label>
                        <input type="password" id="confirm-password" placeholder="Confirm new password" required>
                    </div>
                    <div id="password-error" class="error-message"></div>
                    <button type="submit" class="btn-primary">Change Password</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Serial Number Registration Screen -->
    <div id="licensing-screen" class="screen">
        <div class="auth-container">
            <div class="auth-card">
                <div class="logo-header">
                    <h2>License Registration</h2>
                    <p class="subtitle">Enter your serial number to activate the application</p>
                </div>
                <form id="licensing-form" class="auth-form">
                    <div class="form-group">
                        <label for="licensing-email">Email Address</label>
                        <input type="email" id="licensing-email" readonly class="readonly-input">
                    </div>
                    <div class="form-group">
                        <label for="serial-number">Serial Number</label>
                        <input type="text" id="serial-number" placeholder="Enter serial number provided by admin" required>
                    </div>
                    <div id="licensing-error" class="error-message"></div>
                    <button type="submit" class="btn-primary">Register & Continue</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Campaign Setup Screen -->
    <div id="campaign-setup-screen" class="screen">
        <div class="auth-container">
            <div class="auth-card campaign-setup-card">
                <div class="logo-header">
                    <h2>Campaign Setup</h2>
                    <p class="subtitle">Configure your election campaign details</p>
                </div>
                <form id="campaign-setup-form" class="auth-form">
                    <div class="form-group">
                        <label for="campaign-type">Campaign Type</label>
                        <select id="campaign-type" required>
                            <option value="">Select Campaign Type</option>
                            <option value="WDC">WDC and Local Council</option>
                            <option value="Parliament">Parliament</option>
                            <option value="Presidential">Presidential Election</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="campaign-name">Campaign Name</label>
                        <input type="text" id="campaign-name" placeholder="Enter campaign name" required>
                        <small style="color: var(--text-light); font-size: 12px; margin-top: 5px; display: block;">A logo will be automatically generated from your campaign name initials</small>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="atoll">Atoll</label>
                            <select id="atoll" required>
                                <option value="">Select Atoll</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="constituency">Constituency</label>
                            <select id="constituency" required>
                                <option value="">Select Constituency</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="island">Island</label>
                        <select id="island" required>
                            <option value="">Select Island</option>
                        </select>
                    </div>
                    <div id="campaign-error" class="error-message"></div>
                    <button type="submit" class="btn-primary">Complete Setup</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Officer Ballot Loading Screen -->
    <div id="officer-loading-screen" class="screen">
        <div style="min-height: 100vh; background: var(--light-color); display: flex; align-items: center; justify-content: center; padding: 20px;">
            <div style="background: var(--white); border-radius: 16px; padding: 40px; box-shadow: var(--shadow-lg); max-width: 450px; width: 100%; text-align: center;">
                <div style="margin-bottom: 30px;">
                    <div style="width: 60px; height: 60px; border: 4px solid var(--light-color); border-top-color: var(--primary-color); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 20px;"></div>
                    <h1 style="margin: 0 0 10px 0; color: var(--primary-color);">Loading Ballot Access</h1>
                    <p style="color: var(--text-light); margin: 0;">Please wait...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Officer Ballot Password Entry Screen -->
    <div id="officer-password-screen" class="screen">
        <div style="min-height: 100vh; background: var(--light-color); display: flex; align-items: center; justify-content: center; padding: 20px;">
            <div style="background: var(--white); border-radius: 16px; padding: 40px; box-shadow: var(--shadow-lg); max-width: 450px; width: 100%;">
                <div style="text-align: center; margin-bottom: 30px;">
                    <h1 style="margin: 0 0 10px 0; color: var(--primary-color);">Ballot Access</h1>
                    <p style="color: var(--text-light); margin: 0;">Enter the temporary password to view the ballot list</p>
                </div>
                <form id="officer-password-form" style="margin-bottom: 20px;">
                    <div class="form-group">
                        <label for="officer-password-input">Temporary Password</label>
                        <input type="password" id="officer-password-input" placeholder="Enter password" required autocomplete="off" style="width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 16px;">
                    </div>
                    <div id="officer-password-error" style="color: var(--danger-color); font-size: 14px; margin-top: 10px; display: none;"></div>
                    <button type="submit" class="btn-primary" style="width: 100%; margin-top: 20px;">Access Ballot List</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Officer Ballot View Screen -->
    <div id="officer-ballot-screen" class="screen">
        <div style="min-height: 100vh; background: var(--light-color); padding: 20px;">
            <div style="max-width: 1200px; margin: 0 auto;">
                <div id="officer-ballot-header" style="background: var(--white); border-radius: 16px; padding: 24px; margin-bottom: 24px; box-shadow: var(--shadow-md);">
                    <h1 id="officer-ballot-title" style="margin: 0 0 10px 0;">Ballot List</h1>
                    <p id="officer-ballot-subtitle" style="color: var(--text-light); margin: 0;"></p>
                </div>
                <div id="officer-notification-center" style="background: var(--white); border-radius: 16px; padding: 20px; margin-bottom: 24px; box-shadow: var(--shadow-md); display: none;">
                    <h3 style="margin: 0 0 15px 0; display: flex; align-items: center; gap: 10px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                        </svg>
                        Notifications
                    </h3>
                    <div id="officer-notifications-list"></div>
                </div>
                <div id="officer-ballot-content" style="background: var(--white); border-radius: 16px; padding: 24px; box-shadow: var(--shadow-md);">
                    <div id="officer-loading" style="text-align: center; padding: 40px;">
                        <p>Loading ballot information...</p>
                    </div>
                    <div id="officer-ballot-table-container" style="display: none;">
                        <div style="margin-bottom: 20px;">
                            <div style="position: relative;">
                                <input type="text" id="officer-voter-search" placeholder="Search by name, ID number, or address..." style="width: 100%; padding: 12px 40px 12px 16px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 14px; background: var(--light-color);">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); color: var(--text-light); pointer-events: none;">
                                    <circle cx="11" cy="11" r="8"></circle>
                                    <path d="M21 21l-4.35-4.35"></path>
                                </svg>
                            </div>
                        </div>
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>No.</th>
                                        <th>Name</th>
                                        <th>ID Number</th>
                                        <th>Permanent Address</th>
                                        <th>Ballot</th>
                                        <th>Agent</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="officer-ballot-table-body">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Workspace Screen -->
    <div id="workspace-screen" class="screen">
        <div class="workspace-container">
            <!-- Sidebar -->
            <aside class="sidebar">
                <div class="sidebar-header">
                    <div id="sidebar-campaign-logo" class="sidebar-logo"></div>
                    <div class="sidebar-campaign-info">
                        <h3 id="sidebar-campaign-name">Campaign Name</h3>
                        <p id="sidebar-island-name">Island Name</p>
                    </div>
                </div>
                <nav class="sidebar-nav">
                    <a href="#" class="nav-item active" data-section="dashboard">
                        <span class="nav-icon" data-icon="dashboard"></span>
                        <span class="nav-text">Dashboard</span>
                    </a>
                    <a href="#" class="nav-item" data-section="zero-day" id="zero-day-nav-item" style="display: none;">
                        <span class="nav-icon" data-icon="zero-day"></span>
                        <span class="nav-text">Zero Day</span>
                    </a>
                    <a href="#" class="nav-item" data-section="candidates">
                        <span class="nav-icon" data-icon="candidates"></span>
                        <span class="nav-text">Candidate Management</span>
                    </a>
                    <a href="#" class="nav-item" data-section="voters">
                        <span class="nav-icon" data-icon="voters"></span>
                        <span class="nav-text">Voter Database</span>
                    </a>
                    <a href="#" class="nav-item" data-section="events">
                        <span class="nav-icon" data-icon="events"></span>
                        <span class="nav-text">Campaign Events</span>
                    </a>
                    <a href="#" class="nav-item" data-section="calls">
                        <span class="nav-icon" data-icon="calls"></span>
                        <span class="nav-text">Call Management</span>
                    </a>
                    <a href="#" class="nav-item" data-section="pledges">
                        <span class="nav-icon" data-icon="pledges"></span>
                        <span class="nav-text">Pledge Tracker</span>
                    </a>
                    <a href="#" class="nav-item" data-section="agents">
                        <span class="nav-icon" data-icon="agents"></span>
                        <span class="nav-text">Agent Assignment</span>
                    </a>
                    <a href="#" class="nav-item" data-section="analytics">
                        <span class="nav-icon" data-icon="analytics"></span>
                        <span class="nav-text">Analytics</span>
                    </a>
                    <a href="#" class="nav-item" data-section="settings">
                        <span class="nav-icon" data-icon="settings"></span>
                        <span class="nav-text">Settings</span>
                    </a>
                </nav>
            </aside>

            <!-- Main Content Area -->
            <div class="main-content">
                <!-- Header -->
                <header class="main-header">
                    <div class="header-left">
                        <button class="menu-toggle" id="menu-toggle"><span class="svg-icon" data-icon="menu"></span></button>
                        <nav class="breadcrumb" id="breadcrumb">
                            <a href="#" class="breadcrumb-item" id="breadcrumb-home">Home</a>
                        </nav>
                    </div>
                    <div class="header-right">
                        <button class="header-btn notification-btn" id="notification-btn">
                            <span class="notification-icon svg-icon" data-icon="notification"></span>
                            <span class="notification-badge" id="notification-badge" style="display: none;">0</span>
                        </button>
                        <div class="profile-dropdown">
                            <button class="header-btn profile-btn" id="profile-btn">
                                <span class="profile-avatar svg-icon" data-icon="profile"></span>
                                <span class="profile-name" id="profile-name">User</span>
                            </button>
                            <div class="dropdown-menu" id="profile-menu">
                                <a href="#" class="dropdown-item">Profile</a>
                                <a href="#" class="dropdown-item">Settings</a>
                                <hr class="dropdown-divider">
                                <a href="#" class="dropdown-item" id="logout-btn">Logout</a>
                            </div>
                        </div>
                    </div>
                </header>

                <!-- Notification Center -->
                <div class="notification-center" id="notification-center">
                    <div class="notification-header">
                        <h3>Notifications</h3>
                        <div style="display: flex; gap: 8px; align-items: center;">
                            <button class="btn-secondary btn-compact" id="clear-all-notifications" style="font-size: 12px; padding: 6px 12px; background: var(--primary-color); color: white; border: 1px solid var(--primary-color);" title="Clear All">
                                Clear All
                            </button>
                            <button class="close-btn" id="close-notifications">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <line x1="18" y1="6" x2="6" y2="18"></line>
                                    <line x1="6" y1="6" x2="18" y2="18"></line>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="notification-list" id="notification-list">
                        <div style="text-align: center; padding: 20px; color: rgba(255,255,255,0.7);">
                            <p>Loading notifications...</p>
                        </div>
                    </div>
                </div>

                <!-- Content Area -->
                <main class="content-area" id="content-area">
                    <!-- Content will be dynamically loaded here -->
                </main>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-content">
            <div class="loading-spinner-wrapper">
                <div class="loading-spinner"></div>
            </div>
            <h2 class="loading-title" id="loading-title">Application Updating</h2>
            <div class="loading-subtitle" id="loading-subtitle">Preparing your workspace...</div>
            <div class="loading-percentage" id="loading-percentage" style="margin-top: 20px;">0%</div>
            <div class="loading-progress">
                <div class="loading-progress-bar" id="loading-progress-bar"></div>
            </div>
        </div>
    </div>

    <!-- Messenger Chatbox -->
    <div id="messenger-container" class="messenger-container">
        <div class="messenger-header">
            <div class="messenger-header-left">
                <div class="messenger-title">Messages</div>
                <div class="messenger-subtitle" id="messenger-online-count">0 online</div>
            </div>
            <button class="messenger-close-btn" id="messenger-close-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>

        <div class="messenger-search">
            <input type="text" placeholder="Search conversations..." id="messenger-search-input">
        </div>

        <div class="messenger-users-list" id="messenger-users-list">
            <!-- Online users will be populated here -->
            <div class="messenger-empty">
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" style="opacity: 0.3; margin-bottom: 12px;">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                </svg>
                <p>No online users</p>
                <small>Users from your license will appear here when online</small>
            </div>
        </div>
    </div>

    <!-- Messenger Chat Window -->
    <div id="messenger-chat-window" class="messenger-chat-window">
        <div class="chat-window-header">
            <button class="chat-back-btn" id="chat-back-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="15 18 9 12 15 6"></polyline>
                </svg>
            </button>
            <div class="chat-user-info">
                <div class="chat-user-avatar" id="chat-user-avatar"></div>
                <div class="chat-user-details">
                    <div class="chat-user-name" id="chat-user-name">Messages</div>
                    <div class="chat-user-status" id="chat-user-status">0 online</div>
                </div>
            </div>
            <button class="messenger-close-btn" id="messenger-chat-close-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>

        <div class="chat-messages" id="chat-messages">
            <!-- Messages will be populated here -->
        </div>

        <div class="chat-preview-area" id="chat-preview-area"></div>
        <div class="chat-input-area">
            <button class="chat-attach-btn" title="Attach file">
                <input type="file" id="chat-file-input" accept="image/*,.pdf,.doc,.docx,.txt" multiple>
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path>
                </svg>
            </button>
            <input type="text" placeholder="Type a message..." id="chat-message-input" maxlength="1000">
            <button class="chat-send-btn" id="chat-send-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="22" y1="2" x2="11" y2="13"></line>
                    <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                </svg>
            </button>
        </div>
    </div>

    <!-- Messenger Toggle Button -->
    <button id="messenger-toggle-btn" class="messenger-toggle-btn" title="Open Messages">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
        </svg>
        <span class="messenger-badge" id="messenger-badge">0</span>
    </button>

    <!-- Dialog System (must load first) -->
    <script src="dialog.js"></script>
    <!-- Icons -->
    <script src="icons.js"></script>
    <!-- Pages -->
    <script src="pages.js"></script>
    <!-- Modals -->
    <script src="modals.js"></script>
    <!-- Messenger -->
    <script type="module" src="messenger.js"></script>
    <!-- Firebase SDK -->
    <script type="module" src="app.js"></script>
</body>

</html>