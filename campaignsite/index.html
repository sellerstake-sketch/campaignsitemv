<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Political Election Campaign Management System - Maldives</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAABM0lEQVR4nO2WQU7DMBBFX8qBC1SxQ1Uu0Bu0d+CGC8AF4AhwgXYHqAcgwAHgAhUckEpCJrITj+2JEDOyPNY489mZ8cSJiIiIiIiI/A0KQAUYAB1gCuTAFGgBXaAPlHGzAHaAg0t4B3wBD8BJfvw2UApMjysw2h08AXz7+ISGdxF+BEw6Yk7vO6BR4i9gWeLvfuFPYGxiLq0r8HlVH4E5MAZ64oNO3/gxk0WKrxV4CjSCP2V+s15g1QpUwDz4U+U3KwW6QR+Cp8D7z5gJ1vwNN6P4Qwp9BY7/nDnMPSbwq3XGC3rAtP8X4OvOPGMCL7AFxoK7k/5VaBd4CJz4PzADPgNvQX8CBsAX8AG8Aq/AE/AIPAC3wBWwB5wCO8AJsAVsAhvAGrAKLAMrwBKwyC/wCxx7XuDYC6S+HL7vAf+K98/1wKWa+QAAAABJRU5ErkJggg==">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="pages-styles.css">
    <script type="module" src="dialog.js"></script>
    <script>
        // Detect if opened via file:// protocol and show error
        if (window.location.protocol === 'file:') {
            document.write(`
                <style>
                    body { 
                        font-family: Arial, sans-serif; 
                        text-align: center; 
                        padding: 50px; 
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                    }
                    .error-box {
                        background: rgba(255,255,255,0.95);
                        color: #333;
                        padding: 40px;
                        border-radius: 15px;
                        max-width: 600px;
                        margin: 50px auto;
                        box-shadow: 0 10px 40px rgba(0,0,0,0.3);
                    }
                    h1 { color: #dc3545; margin-bottom: 20px; }
                    .button {
                        display: inline-block;
                        background: #667eea;
                        color: white;
                        padding: 15px 30px;
                        text-decoration: none;
                        border-radius: 8px;
                        margin: 10px;
                        font-weight: bold;
                    }
                    code {
                        background: #f4f4f4;
                        padding: 2px 8px;
                        border-radius: 4px;
                        font-family: monospace;
                    }
                </style>
                <div class="error-box">
                    <h1>⚠️ WRONG WAY TO OPEN THIS FILE!</h1>
                    <p style="font-size: 18px; margin: 20px 0;">
                        You opened this file directly from your computer.<br>
                        This causes CORS errors and won't work!
                    </p>
                    <p style="margin: 30px 0;">
                        <strong>You MUST use the HTTP server instead:</strong>
                    </p>
                    <div style="margin: 30px 0;">
                        <a href="http://localhost:8000/index.html" class="button">Open via Server (Port 8000)</a><br><br>
                        <a href="http://localhost:8080/index.html" class="button">Open via Server (Port 8080)</a>
                    </div>
                    <div style="background: #fff3cd; padding: 20px; border-radius: 8px; margin-top: 30px; text-align: left;">
                        <strong>How to fix:</strong><br>
                        1. Make sure server is running (check terminal)<br>
                        2. Click one of the buttons above<br>
                        3. Or type in browser: <code>http://localhost:8000/index.html</code><br>
                        4. <strong>NEVER</strong> double-click HTML files!
                    </div>
                </div>
            `);
            // Stop execution
            throw new Error('File opened via file:// protocol');
        }
    </script>
</head>

<body class="loading-auth">
    <!-- Unified Login Screen with Tabs -->
    <div id="client-login-screen" class="screen">
        <div class="login-screen-bg">
            <!-- Animated Background Elements -->
            <div class="login-bg-text" id="login-bg-text-1">CAMPAIGN PRO</div>
            <div class="login-bg-text" id="login-bg-text-2">CAMPAIGN PRO</div>
            <div class="login-bg-text" id="login-bg-text-3">CAMPAIGN PRO</div>
            <div class="login-orb login-orb-1"></div>
            <div class="login-orb login-orb-2"></div>
            <div class="login-orb login-orb-3"></div>
        </div>
        <div class="auth-container">
            <div class="auth-card login-card-modern">
                <div class="logo-header">
                    <h1 style="background: linear-gradient(135deg, #6fc1da 0%, #8dd4e8 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 8px;">Campaign Pro</h1>
                    <p class="subtitle">Maldives Political Campaign Management</p>
                </div>

                <!-- Login Tabs -->
                <div class="login-tabs">
                    <button class="login-tab active" data-tab="client" id="tab-client">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 6px;">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                        Client Login
                    </button>
                    <button class="login-tab" data-tab="admin" id="tab-admin">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 6px;">
                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                            <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                        </svg>
                        Admin Login
                    </button>
                </div>

                <!-- Client Login Tab Content -->
                <div class="login-tab-content active" id="tab-content-client">
                    <form id="client-login-form" class="auth-form">
                        <div class="form-group">
                            <label for="client-login-email">Email Address</label>
                            <input type="email" id="client-login-email" placeholder="Enter your email" required>
                        </div>
                        <div class="form-group">
                            <label for="client-login-password">Password</label>
                            <input type="password" id="client-login-password" placeholder="Enter your password" required>
                        </div>
                        <div id="client-login-error" class="error-message"></div>
                        <button type="submit" class="btn-primary">Login</button>
                        <p style="text-align: center; margin-top: 16px; font-size: 13px; color: var(--text-light);">
                            First time? <a href="#" id="switch-to-onboarding" style="color: var(--primary-color); text-decoration: none; font-weight: 600;">Start initial setup</a>
                        </p>
                    </form>
                </div>

                <!-- Initial Setup Form (Hidden by default, shown when link is clicked) -->
                <div class="login-tab-content" id="tab-content-setup" style="display: none;">
                    <form id="onboarding-login-form" class="auth-form">
                        <div class="form-group">
                            <label for="onboarding-email">Email Address</label>
                            <input type="email" id="onboarding-email" placeholder="Enter your email" required>
                        </div>
                        <div class="form-group">
                            <label for="onboarding-password">Temporary Password</label>
                            <input type="password" id="onboarding-password" placeholder="Enter temporary password" required>
                        </div>
                        <div id="onboarding-login-error" class="error-message"></div>
                        <button type="submit" class="btn-primary">Start Setup</button>
                        <p style="text-align: center; margin-top: 16px; font-size: 13px; color: var(--text-light);">
                            Already completed setup? <a href="#" id="switch-to-client-login" style="color: var(--primary-color); text-decoration: none; font-weight: 600;">Login to your account</a>
                        </p>
                    </form>
                </div>

                <!-- Admin Login Tab Content -->
                <div class="login-tab-content" id="tab-content-admin" style="display: none;">
                    <form id="admin-login-form-unified" class="auth-form">
                        <div class="form-group">
                            <label for="admin-email-unified">Admin Email</label>
                            <input type="email" id="admin-email-unified" placeholder="Enter admin email" required>
                        </div>
                        <div class="form-group">
                            <label for="admin-password-unified">Password</label>
                            <input type="password" id="admin-password-unified" placeholder="Enter password" required>
                        </div>
                        <div id="admin-login-error-unified" class="error-message"></div>
                        <button type="submit" class="btn-primary">Login to Admin Panel</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Password Change Screen -->
    <div id="password-change-screen" class="screen">
        <div class="auth-container">
            <div class="auth-card">
                <div class="logo-header">
                    <h2>Change Password</h2>
                    <p class="subtitle">Please set a new password for your account</p>
                </div>
                <form id="password-change-form" class="auth-form">
                    <div class="form-group">
                        <label for="new-password">New Password</label>
                        <input type="password" id="new-password" placeholder="Enter new password" required minlength="6">
                    </div>
                    <div class="form-group">
                        <label for="confirm-password">Confirm New Password</label>
                        <input type="password" id="confirm-password" placeholder="Confirm new password" required>
                    </div>
                    <div id="password-error" class="error-message"></div>
                    <button type="submit" class="btn-primary">Change Password</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Serial Number Registration Screen -->
    <div id="licensing-screen" class="screen">
        <div class="auth-container">
            <div class="auth-card">
                <div class="logo-header">
                    <h2>License Registration</h2>
                    <p class="subtitle">Enter your serial number to activate the application</p>
                </div>
                <form id="licensing-form" class="auth-form">
                    <div class="form-group">
                        <label for="licensing-email">Email Address</label>
                        <input type="email" id="licensing-email" readonly class="readonly-input">
                    </div>
                    <div class="form-group">
                        <label for="serial-number">Serial Number</label>
                        <input type="text" id="serial-number" placeholder="Enter serial number provided by admin" required>
                    </div>
                    <div id="licensing-error" class="error-message"></div>
                    <button type="submit" class="btn-primary">Register & Continue</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Campaign Setup Screen -->
    <div id="campaign-setup-screen" class="screen">
        <div class="auth-container">
            <div class="auth-card campaign-setup-card">
                <div class="logo-header">
                    <h2>Campaign Setup</h2>
                    <p class="subtitle">Configure your election campaign details</p>
                </div>
                <form id="campaign-setup-form" class="auth-form">
                    <div class="form-group">
                        <label for="campaign-type">Campaign Type</label>
                        <select id="campaign-type" required>
                            <option value="">Select Campaign Type</option>
                            <option value="WDC">WDC and Local Council</option>
                            <option value="Parliament">Parliament</option>
                            <option value="Presidential">Presidential Election</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="campaign-name">Campaign Name</label>
                        <input type="text" id="campaign-name" placeholder="Enter campaign name" required>
                        <small style="color: var(--text-light); font-size: 12px; margin-top: 5px; display: block;">A logo will be automatically generated from your campaign name initials</small>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="constituency">Constituency</label>
                            <select id="constituency" required>
                                <option value="">Select Constituency</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="island">Island</label>
                        <select id="island" required>
                            <option value="">Select Island</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="election-date">Election Date</label>
                            <input type="date" id="election-date" required>
                        </div>
                        <div class="form-group">
                            <label for="election-time">Election Time</label>
                            <input type="time" id="election-time" value="08:30" required>
                            <small style="color: var(--text-light); font-size: 12px; margin-top: 5px; display: block;">Default: 08:30 AM</small>
                        </div>
                    </div>
                    <div id="campaign-error" class="error-message"></div>
                    <button type="submit" class="btn-primary">Complete Setup</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Officer Ballot Loading Screen -->
    <div id="officer-loading-screen" class="screen">
        <div style="min-height: 100vh; background: var(--light-color); display: flex; align-items: center; justify-content: center; padding: 20px;">
            <div style="background: var(--white); border-radius: 16px; padding: 40px; box-shadow: var(--shadow-lg); max-width: 450px; width: 100%; text-align: center;">
                <div style="margin-bottom: 30px;">
                    <div style="width: 60px; height: 60px; border: 4px solid var(--light-color); border-top-color: var(--primary-color); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 20px;"></div>
                    <h1 style="margin: 0 0 10px 0; color: var(--primary-color);">Loading Ballot Access</h1>
                    <p style="color: var(--text-light); margin: 0;">Please wait...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Officer Ballot Password Entry Screen -->
    <div id="officer-password-screen" class="screen">
        <div style="min-height: 100vh; background: var(--light-color); display: flex; align-items: center; justify-content: center; padding: 20px;">
            <div style="background: var(--white); border-radius: 16px; padding: 40px; box-shadow: var(--shadow-lg); max-width: 450px; width: 100%;">
                <div style="text-align: center; margin-bottom: 30px;">
                    <h1 style="margin: 0 0 10px 0; color: var(--primary-color);">Ballot Access</h1>
                    <p style="color: var(--text-light); margin: 0;">Enter the temporary password to view the ballot list</p>
                </div>
                <form id="officer-password-form" style="margin-bottom: 20px;">
                    <div class="form-group">
                        <label for="officer-password-input">Temporary Password</label>
                        <input type="password" id="officer-password-input" placeholder="Enter password" required autocomplete="off" style="width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 16px;">
                    </div>
                    <div id="officer-password-error" style="color: var(--danger-color); font-size: 14px; margin-top: 10px; display: none;"></div>
                    <button type="submit" class="btn-primary" style="width: 100%; margin-top: 20px;">Access Ballot List</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Officer Ballot View Screen -->
    <div id="officer-ballot-screen" class="screen">
        <div style="min-height: 100vh; background: var(--light-color); padding: 20px;">
            <div style="max-width: 1200px; margin: 0 auto;">
                <div id="officer-ballot-header" style="background: var(--white); border-radius: 16px; padding: 24px; margin-bottom: 24px; box-shadow: var(--shadow-md);">
                    <h1 id="officer-ballot-title" style="margin: 0 0 10px 0;">Ballot List</h1>
                    <p id="officer-ballot-subtitle" style="color: var(--text-light); margin: 0;"></p>
                </div>
                <div id="officer-notification-center" style="background: var(--white); border-radius: 16px; padding: 20px; margin-bottom: 24px; box-shadow: var(--shadow-md); display: none;">
                    <h3 style="margin: 0 0 15px 0; display: flex; align-items: center; gap: 10px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                        </svg>
                        Notifications
                    </h3>
                    <div id="officer-notifications-list"></div>
                </div>
                <div id="officer-ballot-content" style="background: var(--white); border-radius: 16px; padding: 24px; box-shadow: var(--shadow-md);">
                    <div id="officer-loading" style="text-align: center; padding: 40px;">
                        <p>Loading ballot information...</p>
                    </div>
                    <div id="officer-ballot-table-container" style="display: none;">
                        <div style="margin-bottom: 20px;">
                            <div style="position: relative;">
                                <input type="text" id="officer-voter-search" placeholder="Search by Ballot Sequence No (primary), name, ID number, or address..." style="width: 100%; padding: 12px 40px 12px 16px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 14px; background: var(--light-color);">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); color: var(--text-light); pointer-events: none;">
                                    <circle cx="11" cy="11" r="8"></circle>
                                    <path d="M21 21l-4.35-4.35"></path>
                                </svg>
                            </div>
                        </div>
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>No. (Ballot)</th>
                                        <th>Ballot Box Sequence</th>
                                        <th>Name</th>
                                        <th>ID Number</th>
                                        <th>Permanent Address</th>
                                        <th>Ballot</th>
                                        <th>Agent</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="officer-ballot-table-body">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Workspace Screen -->
    <div id="workspace-screen" class="screen">
        <div class="workspace-container">
            <!-- Sidebar -->
            <aside class="sidebar" id="main-sidebar">
                <button class="sidebar-toggle" id="sidebar-toggle" title="Toggle Sidebar">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                </button>
                <div class="sidebar-header">
                    <div class="sidebar-header-vector">
                        <svg viewBox="0 0 400 250" xmlns="http://www.w3.org/2000/svg" class="election-vector-sidebar">
                            <defs>
                                <linearGradient id="sidebarPersonGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color:rgba(111,193,218,0.3);stop-opacity:1" />
                                    <stop offset="100%" style="stop-color:rgba(141,212,232,0.25);stop-opacity:1" />
                                </linearGradient>
                                <linearGradient id="sidebarCheckGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color:rgba(111,193,218,0.4);stop-opacity:1" />
                                    <stop offset="100%" style="stop-color:rgba(255,255,255,0.3);stop-opacity:1" />
                                </linearGradient>
                                <filter id="sidebarGlow">
                                    <feGaussianBlur stdDeviation="3" result="coloredBlur" />
                                    <feMerge>
                                        <feMergeNode in="coloredBlur" />
                                        <feMergeNode in="SourceGraphic" />
                                    </feMerge>
                                </filter>
                            </defs>

                            <!-- Person 1 - Voter at Ballot Box -->
                            <g class="sidebar-person-1">
                                <!-- Head -->
                                <circle cx="80" cy="120" r="8" fill="url(#sidebarPersonGradient)" stroke="rgba(255,255,255,0.2)" stroke-width="1" opacity="0.7" />
                                <!-- Body -->
                                <rect x="74" y="128" width="12" height="25" rx="3" fill="url(#sidebarPersonGradient)" stroke="rgba(255,255,255,0.2)" stroke-width="1" opacity="0.7" />
                                <!-- Arms -->
                                <line x1="74" y1="135" x2="65" y2="145" stroke="rgba(111,193,218,0.4)" stroke-width="3" stroke-linecap="round" opacity="0.7" />
                                <line x1="86" y1="135" x2="95" y2="145" stroke="rgba(111,193,218,0.4)" stroke-width="3" stroke-linecap="round" opacity="0.7" />
                                <!-- Legs -->
                                <line x1="77" y1="153" x2="77" y2="170" stroke="rgba(111,193,218,0.4)" stroke-width="3" stroke-linecap="round" opacity="0.7" />
                                <line x1="83" y1="153" x2="83" y2="170" stroke="rgba(111,193,218,0.4)" stroke-width="3" stroke-linecap="round" opacity="0.7" />
                                <!-- Ballot in hand -->
                                <rect x="65" y="140" width="12" height="18" rx="2" fill="rgba(255,255,255,0.2)" stroke="rgba(111,193,218,0.3)" stroke-width="1" opacity="0.8" />
                                <line x1="67" y1="145" x2="75" y2="145" stroke="rgba(111,193,218,0.3)" stroke-width="0.8" />
                                <line x1="67" y1="150" x2="75" y2="150" stroke="rgba(111,193,218,0.3)" stroke-width="0.8" />
                            </g>

                            <!-- Person 2 - Election Worker -->
                            <g class="sidebar-person-2">
                                <!-- Head -->
                                <circle cx="200" cy="100" r="8" fill="url(#sidebarPersonGradient)" stroke="rgba(255,255,255,0.2)" stroke-width="1" opacity="0.7" />
                                <!-- Body -->
                                <rect x="194" y="108" width="12" height="25" rx="3" fill="url(#sidebarPersonGradient)" stroke="rgba(255,255,255,0.2)" stroke-width="1" opacity="0.7" />
                                <!-- Arms raised (working) -->
                                <line x1="194" y1="115" x2="185" y2="105" stroke="rgba(111,193,218,0.4)" stroke-width="3" stroke-linecap="round" opacity="0.7" />
                                <line x1="206" y1="115" x2="215" y2="105" stroke="rgba(111,193,218,0.4)" stroke-width="3" stroke-linecap="round" opacity="0.7" />
                                <!-- Legs -->
                                <line x1="197" y1="133" x2="197" y2="150" stroke="rgba(111,193,218,0.4)" stroke-width="3" stroke-linecap="round" opacity="0.7" />
                                <line x1="203" y1="133" x2="203" y2="150" stroke="rgba(111,193,218,0.4)" stroke-width="3" stroke-linecap="round" opacity="0.7" />
                                <!-- Clipboard/Tablet -->
                                <rect x="180" y="105" width="10" height="12" rx="1" fill="rgba(255,255,255,0.2)" stroke="rgba(111,193,218,0.3)" stroke-width="1" opacity="0.8" />
                            </g>

                            <!-- Person 3 - Voter Filling Ballot -->
                            <g class="sidebar-person-3">
                                <!-- Head -->
                                <circle cx="320" cy="130" r="8" fill="url(#sidebarPersonGradient)" stroke="rgba(255,255,255,0.2)" stroke-width="1" opacity="0.7" />
                                <!-- Body -->
                                <rect x="314" y="138" width="12" height="25" rx="3" fill="url(#sidebarPersonGradient)" stroke="rgba(255,255,255,0.2)" stroke-width="1" opacity="0.7" />
                                <!-- Arms (writing position) -->
                                <line x1="314" y1="145" x2="305" y2="155" stroke="rgba(111,193,218,0.4)" stroke-width="3" stroke-linecap="round" opacity="0.7" />
                                <line x1="326" y1="145" x2="335" y2="155" stroke="rgba(111,193,218,0.4)" stroke-width="3" stroke-linecap="round" opacity="0.7" />
                                <!-- Legs -->
                                <line x1="317" y1="163" x2="317" y2="180" stroke="rgba(111,193,218,0.4)" stroke-width="3" stroke-linecap="round" opacity="0.7" />
                                <line x1="323" y1="163" x2="323" y2="180" stroke="rgba(111,193,218,0.4)" stroke-width="3" stroke-linecap="round" opacity="0.7" />
                                <!-- Ballot on table -->
                                <rect x="295" y="150" width="25" height="18" rx="2" fill="rgba(255,255,255,0.25)" stroke="rgba(111,193,218,0.35)" stroke-width="1.5" opacity="0.8" />
                                <line x1="298" y1="155" x2="318" y2="155" stroke="rgba(111,193,218,0.3)" stroke-width="1" />
                                <line x1="298" y1="160" x2="315" y2="160" stroke="rgba(111,193,218,0.3)" stroke-width="1" />
                                <line x1="298" y1="165" x2="318" y2="165" stroke="rgba(111,193,218,0.3)" stroke-width="1" />
                                <!-- Checkbox with tick -->
                                <rect x="300" y="156" width="6" height="6" rx="1" fill="rgba(111,193,218,0.3)" stroke="rgba(111,193,218,0.5)" stroke-width="0.8" />
                                <path d="M 301.5 158 L 303 159.5 L 305.5 157" stroke="rgba(255,255,255,0.6)" stroke-width="1" fill="none" stroke-linecap="round" />
                            </g>

                            <!-- Ballot Box -->
                            <g class="sidebar-ballot-box">
                                <rect x="100" y="160" width="80" height="70" rx="5" fill="rgba(111,193,218,0.2)" stroke="rgba(111,193,218,0.35)" stroke-width="2" filter="url(#sidebarGlow)" opacity="0.7" />
                                <rect x="108" y="168" width="64" height="50" rx="3" fill="rgba(255,255,255,0.08)" />
                                <rect x="115" y="175" width="50" height="35" rx="2" fill="rgba(111,193,218,0.12)" />
                                <rect x="120" y="145" width="40" height="18" rx="3" fill="rgba(111,193,218,0.25)" stroke="rgba(255,255,255,0.3)" stroke-width="1.5" />
                                <rect x="95" y="230" width="90" height="10" rx="5" fill="rgba(111,193,218,0.2)" />
                            </g>

                            <!-- Multiple Checkmarks/Ticks -->
                            <g class="sidebar-checkmarks">
                                <!-- Checkmark 1 -->
                                <g class="checkmark-1">
                                    <circle cx="50" cy="60" r="12" fill="rgba(111,193,218,0.12)" opacity="0.6" />
                                    <path d="M 43 60 L 47 64 L 57 54" stroke="url(#sidebarCheckGradient)" stroke-width="3" fill="none" stroke-linecap="round" stroke-linejoin="round" opacity="0.8" filter="url(#sidebarGlow)" />
                                </g>
                                <!-- Checkmark 2 -->
                                <g class="checkmark-2">
                                    <circle cx="350" cy="80" r="10" fill="rgba(111,193,218,0.12)" opacity="0.6" />
                                    <path d="M 344 80 L 347 83 L 356 74" stroke="url(#sidebarCheckGradient)" stroke-width="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round" opacity="0.8" />
                                </g>
                                <!-- Checkmark 3 -->
                                <g class="checkmark-3">
                                    <circle cx="180" cy="200" r="9" fill="rgba(111,193,218,0.12)" opacity="0.6" />
                                    <path d="M 174 200 L 177 203 L 186 194" stroke="url(#sidebarCheckGradient)" stroke-width="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round" opacity="0.8" />
                                </g>
                            </g>

                            <!-- Ballots Scattered -->
                            <g class="sidebar-ballots">
                                <!-- Ballot 1 -->
                                <rect x="30" y="200" width="15" height="20" rx="2" fill="rgba(255,255,255,0.15)" stroke="rgba(111,193,218,0.3)" stroke-width="1" opacity="0.6" transform="rotate(-15 37.5 210)" />
                                <line x1="32" y1="205" x2="43" y2="205" stroke="rgba(111,193,218,0.25)" stroke-width="0.8" />
                                <!-- Ballot 2 -->
                                <rect x="360" y="200" width="15" height="20" rx="2" fill="rgba(255,255,255,0.15)" stroke="rgba(111,193,218,0.3)" stroke-width="1" opacity="0.6" transform="rotate(10 367.5 210)" />
                                <line x1="362" y1="205" x2="373" y2="205" stroke="rgba(111,193,218,0.25)" stroke-width="0.8" />
                            </g>

                            <!-- Voting Booth/Table -->
                            <g class="sidebar-voting-booth">
                                <rect x="280" y="145" width="60" height="4" rx="2" fill="rgba(111,193,218,0.2)" opacity="0.6" />
                                <rect x="285" y="149" width="50" height="3" rx="1" fill="rgba(111,193,218,0.15)" opacity="0.6" />
                            </g>
                        </svg>
                    </div>
                    <div id="sidebar-campaign-logo" class="sidebar-logo"></div>
                    <div class="sidebar-campaign-info">
                        <h3 id="sidebar-campaign-name">Campaign Name</h3>
                        <p id="sidebar-island-name">Island Name</p>
                    </div>
                </div>
                <nav class="sidebar-nav">
                    <a href="#" class="nav-item active" data-section="dashboard">
                        <span class="nav-icon" data-icon="dashboard"></span>
                        <span class="nav-text">Dashboard</span>
                    </a>
                    <a href="#" class="nav-item" data-section="zero-day" id="zero-day-nav-item" style="display: none;">
                        <span class="nav-icon" data-icon="zero-day"></span>
                        <span class="nav-text">Zero Day</span>
                    </a>
                    <a href="#" class="nav-item" data-section="candidates">
                        <span class="nav-icon" data-icon="candidates"></span>
                        <span class="nav-text">Candidate Management</span>
                    </a>
                    <a href="#" class="nav-item" data-section="voters">
                        <span class="nav-icon" data-icon="voters"></span>
                        <span class="nav-text">Voter Database</span>
                    </a>
                    <a href="#" class="nav-item" data-section="events">
                        <span class="nav-icon" data-icon="events"></span>
                        <span class="nav-text">Campaign Events</span>
                    </a>
                    <a href="#" class="nav-item" data-section="calls">
                        <span class="nav-icon" data-icon="calls"></span>
                        <span class="nav-text">Call Management</span>
                    </a>
                    <a href="#" class="nav-item" data-section="pledges">
                        <span class="nav-icon" data-icon="pledges"></span>
                        <span class="nav-text">Pledge Tracker</span>
                    </a>
                    <a href="#" class="nav-item" data-section="agents">
                        <span class="nav-icon" data-icon="agents"></span>
                        <span class="nav-text">Agent Assignment</span>
                    </a>
                    <a href="#" class="nav-item" data-section="analytics">
                        <span class="nav-icon" data-icon="analytics"></span>
                        <span class="nav-text">Analytics</span>
                    </a>
                    <a href="#" class="nav-item" data-section="settings">
                        <span class="nav-icon" data-icon="settings"></span>
                        <span class="nav-text">Settings</span>
                    </a>
                </nav>
            </aside>

            <!-- Mobile Bottom Navigation Dock -->
            <nav class="mobile-bottom-nav" id="mobile-bottom-nav">
                <!-- Left Side -->
                <a href="#" class="mobile-nav-item" data-section="voters" title="Database">
                    <span class="mobile-nav-icon" data-icon="voters"></span>
                    <span class="mobile-nav-label">Database</span>
                </a>
                <a href="#" class="mobile-nav-item" data-section="pledges" title="Pledge Tracker">
                    <span class="mobile-nav-icon" data-icon="pledges"></span>
                    <span class="mobile-nav-label">Pledge Tracker</span>
                </a>

                <!-- Center - Dashboard (Highlighted) -->
                <a href="#" class="mobile-nav-item mobile-nav-center active" data-section="dashboard" title="Dashboard">
                    <span class="mobile-nav-icon" data-icon="dashboard"></span>
                    <span class="mobile-nav-label">Dashboard</span>
                </a>

                <!-- Right Side -->
                <a href="#" class="mobile-nav-item" data-section="agents" title="Agent Assignment">
                    <span class="mobile-nav-icon" data-icon="agents"></span>
                    <span class="mobile-nav-label">Agent Assignment</span>
                </a>

                <!-- More Menu -->
                <button class="mobile-nav-item mobile-nav-more" id="mobile-nav-more-btn" title="More">
                    <span class="mobile-nav-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="1"></circle>
                            <circle cx="19" cy="12" r="1"></circle>
                            <circle cx="5" cy="12" r="1"></circle>
                        </svg>
                    </span>
                    <span class="mobile-nav-label">More</span>
                </button>
            </nav>

            <!-- More Menu Popup -->
            <div class="mobile-more-menu" id="mobile-more-menu">
                <div class="mobile-more-menu-content">
                    <div class="mobile-more-menu-header">
                        <h3>More Options</h3>
                        <button class="mobile-more-menu-close" id="mobile-more-menu-close">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="18" y1="6" x2="6" y2="18"></line>
                                <line x1="6" y1="6" x2="18" y2="18"></line>
                            </svg>
                        </button>
                    </div>
                    <div class="mobile-more-menu-items">
                        <a href="#" class="mobile-more-menu-item" data-section="events">
                            <span class="mobile-more-menu-icon" data-icon="events"></span>
                            <span class="mobile-more-menu-label">Campaign Events</span>
                        </a>
                        <a href="#" class="mobile-more-menu-item" data-section="candidates">
                            <span class="mobile-more-menu-icon" data-icon="candidates"></span>
                            <span class="mobile-more-menu-label">Candidates</span>
                        </a>
                        <a href="#" class="mobile-more-menu-item" data-section="calls">
                            <span class="mobile-more-menu-icon" data-icon="calls"></span>
                            <span class="mobile-more-menu-label">Calls</span>
                        </a>
                        <a href="#" class="mobile-more-menu-item" data-section="analytics">
                            <span class="mobile-more-menu-icon" data-icon="analytics"></span>
                            <span class="mobile-more-menu-label">Analytics</span>
                        </a>
                        <a href="#" class="mobile-more-menu-item" data-section="settings">
                            <span class="mobile-more-menu-icon" data-icon="settings"></span>
                            <span class="mobile-more-menu-label">Settings</span>
                        </a>
                        <a href="#" class="mobile-more-menu-item" data-section="zero-day" id="mobile-more-zero-day" style="display: none;">
                            <span class="mobile-more-menu-icon" data-icon="zero-day"></span>
                            <span class="mobile-more-menu-label">Zero Day</span>
                        </a>
                    </div>
                </div>
                <div class="mobile-more-menu-backdrop" id="mobile-more-menu-backdrop"></div>
            </div>

            <!-- Main Content Area -->
            <div class="main-content">
                <!-- Header -->
                <header class="main-header">
                    <div class="header-left">
                        <button class="menu-toggle" id="menu-toggle"><span class="svg-icon" data-icon="menu"></span></button>
                        <nav class="breadcrumb" id="breadcrumb">
                        </nav>
                    </div>
                    <div class="header-center">
                        <div id="global-filter-container" class="global-filter" style="display: flex; gap: 12px; align-items: center;">
                            <select id="global-filter-island" class="filter-select" disabled style="padding: 8px 12px; border: 1px solid var(--border-color); border-radius: 8px; background: white; font-size: 14px; cursor: not-allowed; min-width: 180px; opacity: 0.6;">
                                <option value="">All Islands</option>
                            </select>
                            <select id="global-filter-constituency" class="filter-select" disabled style="padding: 8px 12px; border: 1px solid var(--border-color); border-radius: 8px; background: white; font-size: 14px; cursor: not-allowed; min-width: 200px; opacity: 0.6;">
                                <option value="">Show All</option>
                            </select>
                        </div>
                    </div>
                    <div class="header-right">
                        <div class="refresh-btn-wrapper" style="position: relative; display: flex; align-items: center;">
                            <button class="header-btn refresh-btn" id="refresh-btn" title="Refresh Data">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polyline points="23 4 23 10 17 10"></polyline>
                                    <polyline points="1 20 1 14 7 14"></polyline>
                                    <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                                </svg>
                            </button>
                            <span id="refresh-status-message" class="refresh-status-message" style="display: none;"></span>
                        </div>
                        <button class="header-btn notification-btn" id="notification-btn">
                            <span class="notification-icon svg-icon" data-icon="notification"></span>
                            <span class="notification-badge" id="notification-badge" style="display: none;">0</span>
                        </button>
                        <div class="profile-dropdown">
                            <button class="profile-trigger" id="profile-btn" aria-label="Profile menu">
                                <div class="profile-avatar-wrapper">
                                    <div class="profile-avatar" id="profile-avatar">
                                        <span class="profile-initials" id="profile-initials">U</span>
                                    </div>
                                    <div class="profile-status-indicator"></div>
                                </div>
                                <div class="profile-info">
                                    <span class="profile-name" id="profile-name">User</span>
                                    <span class="profile-email" id="profile-email">user@example.com</span>
                                </div>
                                <svg class="profile-chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polyline points="6 9 12 15 18 9"></polyline>
                                </svg>
                            </button>
                            <div class="profile-menu" id="profile-menu">
                                <div class="profile-menu-header">
                                    <div class="profile-menu-avatar-wrapper">
                                        <div class="profile-menu-avatar" id="profile-menu-avatar">
                                            <span class="profile-menu-initials" id="profile-menu-initials">U</span>
                                        </div>
                                    </div>
                                    <div class="profile-menu-info">
                                        <div class="profile-menu-name" id="profile-menu-name">User Name</div>
                                        <div class="profile-menu-email" id="profile-menu-email">user@example.com</div>
                                    </div>
                                </div>
                                <div class="profile-menu-divider"></div>
                                <div class="profile-menu-items">
                                    <a href="#" class="profile-menu-item" id="profile-menu-profile">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                            <circle cx="12" cy="7" r="4"></circle>
                                        </svg>
                                        <span>My Profile</span>
                                    </a>
                                    <a href="#" class="profile-menu-item" id="profile-menu-settings">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <circle cx="12" cy="12" r="3"></circle>
                                            <path d="M12 1v6m0 6v6M5.64 5.64l4.24 4.24m4.24 4.24l4.24 4.24M1 12h6m6 0h6M5.64 18.36l4.24-4.24m4.24-4.24l4.24-4.24"></path>
                                        </svg>
                                        <span>Settings</span>
                                    </a>
                                    <a href="#" class="profile-menu-item" id="profile-menu-change-password">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                                            <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                                        </svg>
                                        <span>Change Password</span>
                                    </a>
                                    <div class="profile-menu-divider"></div>
                                    <a href="#" class="profile-menu-item profile-menu-item-danger" id="logout-btn">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                                            <polyline points="16 17 21 12 16 7"></polyline>
                                            <line x1="21" y1="12" x2="9" y2="12"></line>
                                        </svg>
                                        <span>Logout</span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </header>


                <!-- Notification Center -->
                <div class="notification-center" id="notification-center">
                    <div class="notification-header">
                        <h3>Notifications</h3>
                        <div style="display: flex; gap: 8px; align-items: center;">
                            <button class="btn-secondary btn-compact" id="clear-all-notifications" style="font-size: 12px; padding: 6px 12px; background: var(--primary-color); color: white; border: 1px solid var(--primary-color);" title="Clear All">
                                Clear All
                            </button>
                            <button class="close-btn" id="close-notifications">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <line x1="18" y1="6" x2="6" y2="18"></line>
                                    <line x1="6" y1="6" x2="18" y2="18"></line>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="notification-list" id="notification-list">
                        <div style="text-align: center; padding: 20px; color: rgba(255,255,255,0.7);">
                            <p>Loading notifications...</p>
                        </div>
                    </div>
                </div>

                <!-- Content Area -->
                <main class="content-area" id="content-area">
                    <!-- Content will be dynamically loaded here -->
                </main>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <!-- Animated Background Elements -->
        <div class="loading-bg-text" id="loading-bg-text-1"></div>
        <div class="loading-bg-text" id="loading-bg-text-2"></div>
        <div class="loading-bg-text" id="loading-bg-text-3"></div>

        <!-- Floating Orbs -->
        <div class="loading-orb loading-orb-1"></div>
        <div class="loading-orb loading-orb-2"></div>
        <div class="loading-orb loading-orb-3"></div>

        <div class="loading-content">
            <div class="loading-spinner-wrapper">
                <div class="loading-spinner"></div>
            </div>
            <h2 class="loading-title" id="loading-title">Application Updating</h2>
            <div class="loading-subtitle" id="loading-subtitle">Preparing your workspace...</div>
            <div class="loading-percentage" id="loading-percentage" style="margin-top: 20px;">0%</div>
            <div class="loading-progress">
                <div class="loading-progress-bar" id="loading-progress-bar"></div>
            </div>
        </div>
    </div>

    <!-- Dialog System (must load first) -->
    <script src="dialog.js"></script>
    <!-- Icons -->
    <script src="icons.js"></script>
    <!-- Pages -->
    <script src="pages.js"></script>
    <!-- Modals -->
    <script src="modals.js"></script>
    <!-- Island Users Management -->
    <script src="island-users.js"></script>
    <!-- Firebase SDK -->
    <script type="module" src="app.js"></script>
</body>

</html>